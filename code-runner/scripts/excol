#!/usr/bin/env python3
"""Extract dominant colors from an image using colorthief"""

import sys
import json
from colorthief import ColorThief

def rgb_to_hex(rgb):
    return '#{:02x}{:02x}{:02x}'.format(*rgb)

def main():
    if len(sys.argv) < 2:
        print(json.dumps({"error": "Usage: excol <image_path> [count]"}))
        sys.exit(1)
    
    image_path = sys.argv[1]
    count = int(sys.argv[2]) if len(sys.argv) > 2 else 5
    
    try:
        ct = ColorThief(image_path)
        
        # Get dominant color
        dominant = ct.get_color(quality=1)
        
        # Get color palette
        palette = ct.get_palette(color_count=count, quality=1)
        
        result = {
            "dominant": rgb_to_hex(dominant),
            "palette": [rgb_to_hex(c) for c in palette]
        }
        
        print(json.dumps(result))
    except Exception as e:
        print(json.dumps({"error": str(e)}))
        sys.exit(1)

if __name__ == "__main__":
    main()
